name: daily-study

on:
  schedule:
    # ë” ë‹¤ì–‘í•œ ì‹œê°„ëŒ€ë¡œ ë¶„ì‚°
    - cron: '25 6 * * *'
    - cron: '15 7 * * *'
    - cron: '45 8 * * *' 
    - cron: '20 9 * * *'
    - cron: '35 10 * * *'
    - cron: '50 11 * * *'
    - cron: '10 13 * * *'
    - cron: '30 14 * * *'
    - cron: '40 16 * * *'
    - cron: '55 18 * * *'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  commit:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set git user
        run: |
          git config --global user.name "mingMy-00"
          git config --global user.email "wbsebqb1118@naver.com"

      - name: Create study activities
        run: |
          today=$(date +'%Y-%m-%d')
          mkdir -p notes docs examples
          
          # ì˜¤ëŠ˜ ì´ë¯¸ í™œë™í–ˆëŠ”ì§€ ì²´í¬
          if [ -f "notes/$today.md" ] || [ -f "docs/$today.md" ] || [ -f "examples/$today.md" ]; then
            echo "Already active today."
            exit 0
          fi
          
          # ë‹¤ì–‘í•œ í™œë™ íƒ€ì… (30% í™•ë¥ ë¡œ ì—¬ëŸ¬ í™œë™)
          should_create_multiple=$((RANDOM % 10))
          
          # í™œë™ ë‚´ìš©ë“¤
          note_contents=(
            "# React ê°œë… ì •ë¦¬\n\n## useState Hook\n- ìƒíƒœ ê´€ë¦¬ë¥¼ ìœ„í•œ ê¸°ë³¸ Hook\n- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœ ì‚¬ìš© ê°€ëŠ¥\n\n## ì˜ˆì œ\n\`\`\`javascript\nconst [count, setCount] = useState(0);\n\`\`\`"
            "# JavaScript ë¹„ë™ê¸° ì²˜ë¦¬\n\n## Promise\n- ë¹„ë™ê¸° ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´\n- then, catch ë©”ì„œë“œë¡œ ì²˜ë¦¬\n\n## async/await\n- Promiseë¥¼ ë” ì§ê´€ì ìœ¼ë¡œ ì‚¬ìš©\n- ë™ê¸° ì½”ë“œì²˜ëŸ¼ ì‘ì„± ê°€ëŠ¥"
            "# CSS Flexbox ì •ë¦¬\n\n## ì£¼ìš” ì†ì„±\n- display: flex\n- justify-content: ì£¼ì¶• ì •ë ¬\n- align-items: êµì°¨ì¶• ì •ë ¬\n\n## í™œìš© ì˜ˆì œ\në°˜ì‘í˜• ë ˆì´ì•„ì›ƒ êµ¬ì„±ì— ìœ ìš©"
            "# ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í•´ê²°\n\n## ì˜¤ëŠ˜ í‘¼ ë¬¸ì œ\n- íˆ¬ í¬ì¸í„° ê¸°ë²• í™œìš©\n- ì‹œê°„ë³µì¡ë„ O(n)ìœ¼ë¡œ ìµœì í™”\n\n## í•µì‹¬ ì•„ì´ë””ì–´\në°°ì—´ì˜ ì–‘ëì—ì„œ ì‹œì‘í•˜ì—¬ ì¡°ê±´ì— ë”°ë¼ í¬ì¸í„° ì´ë™"
            "# Git ë¸Œëœì¹˜ ì „ëµ\n\n## Git Flow\n- main: í”„ë¡œë•ì…˜ ë¸Œëœì¹˜\n- develop: ê°œë°œ ë¸Œëœì¹˜\n- feature: ê¸°ëŠ¥ ê°œë°œ\n\n## ìœ ìš©í•œ ëª…ë ¹ì–´\n\`git checkout -b feature/new-feature\`"
            "# API ì„¤ê³„ ì›ì¹™\n\n## RESTful API\n- ìì› ì¤‘ì‹¬ì˜ URL ì„¤ê³„\n- HTTP ë©”ì„œë“œ í™œìš©\n- ìƒíƒœì½”ë“œ ì ì ˆíˆ ì‚¬ìš©\n\n## ì˜ˆì‹œ\nGET /api/users/123\nPOST /api/users\nPUT /api/users/123"
            "# ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”\n\n## ì¸ë±ìŠ¤ í™œìš©\n- ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ\n- WHERE ì ˆì— ìì£¼ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ì— ìƒì„±\n\n## ì¿¼ë¦¬ ìµœì í™”\n- ë¶ˆí•„ìš”í•œ SELECT * ì§€ì–‘\n- JOIN ì¡°ê±´ ëª…í™•íˆ ì‘ì„±"
          )
          
          doc_contents=(
            "# í”„ë¡œì íŠ¸ ê¸°íšì„œ\n\n## ëª©í‘œ\nê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ ì›¹ì‚¬ì´íŠ¸ ì œì‘\n\n## ê¸°ìˆ  ìŠ¤íƒ\n- Frontend: React, TypeScript\n- Styling: Tailwind CSS\n- Deployment: Vercel"
            "# ì½”ë”© ì»¨ë²¤ì…˜\n\n## JavaScript\n- camelCase ì‚¬ìš©\n- const > let > var\n- í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ì§€í–¥\n\n## CSS\n- BEM ë°©ë²•ë¡  ì ìš©\n- ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸ ì ‘ê·¼"
            "# í•™ìŠµ ë¡œë“œë§µ\n\n## ë‹¨ê¸° ëª©í‘œ (1ê°œì›”)\n- React Hook ë§ˆìŠ¤í„°\n- TypeScript ê¸°ì´ˆ ì™„ì„±\n\n## ì¤‘ê¸° ëª©í‘œ (3ê°œì›”)\n- Next.js í”„ë¡œì íŠ¸ ì™„ì„±\n- í¬íŠ¸í´ë¦¬ì˜¤ ì‚¬ì´íŠ¸ ë°°í¬"
          )
          
          example_contents=(
            "# React Hook ì˜ˆì œ\n\n\`\`\`javascript\nimport { useState, useEffect } from 'react';\n\nfunction Timer() {\n  const [count, setCount] = useState(0);\n  \n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCount(c => c + 1);\n    }, 1000);\n    \n    return () => clearInterval(timer);\n  }, []);\n  \n  return <div>Count: {count}</div>;\n}\n\`\`\`"
            "# API í˜¸ì¶œ ì˜ˆì œ\n\n\`\`\`javascript\nasync function fetchUser(id) {\n  try {\n    const response = await fetch(\`/api/users/\${id}\`);\n    const user = await response.json();\n    return user;\n  } catch (error) {\n    console.error('Failed to fetch user:', error);\n    throw error;\n  }\n}\n\`\`\`"
            "# CSS Grid ë ˆì´ì•„ì›ƒ\n\n\`\`\`css\n.container {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 20px;\n  padding: 20px;\n}\n\n.item {\n  background: #f0f0f0;\n  padding: 15px;\n  border-radius: 8px;\n}\n\`\`\`"
          )
          
          commit_messages=(
            "docs: í•™ìŠµ ë‚´ìš© ì •ë¦¬ ë° ì—…ë°ì´íŠ¸"
            "study: ìƒˆë¡œìš´ ê°œë… í•™ìŠµ ê¸°ë¡"
            "notes: ê°œë°œ ê´€ë ¨ ë©”ëª¨ ì¶”ê°€"
            "docs: ê¸°ìˆ  ìŠ¤íƒ ë¬¸ì„œí™”"
            "update: í”„ë¡œì íŠ¸ ì§„í–‰ìƒí™© ê¸°ë¡"
            "memo: ì½”ë”© íŒ ë° ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤"
            "docs: ê°œë°œ í™˜ê²½ ì„¤ì • ê°€ì´ë“œ"
            "study: ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í•´ê²° ê³¼ì •"
            "notes: ì•„ì´ë””ì–´ ë° ê°œì„ ì‚¬í•­ ê¸°ë¡"
            "update: í•™ìŠµ ì§„ë„ ë° ê³„íš ìˆ˜ì •"
            "refactor: ì½”ë“œ ì˜ˆì œ ê°œì„ "
            "feat: ìƒˆë¡œìš´ ì˜ˆì œ ì½”ë“œ ì¶”ê°€"
            "fix: ë¬¸ì„œ ì˜¤íƒ€ ë° ë‚´ìš© ìˆ˜ì •"
            "chore: íŒŒì¼ êµ¬ì¡° ì •ë¦¬"
          )
          
          # í™œë™ ìƒì„±
          activity_type=$((RANDOM % 3))
          content_index=$((RANDOM % 7))
          message_index=$((RANDOM % ${#commit_messages[@]}))
          
          case $activity_type in
            0)
              # Notes í™œë™
              file_path="notes/$today.md"
              echo -e "${note_contents[$content_index]}" > "$file_path"
              ;;
            1)
              # Docs í™œë™  
              file_path="docs/$today.md"
              doc_index=$((RANDOM % ${#doc_contents[@]}))
              echo -e "${doc_contents[$doc_index]}" > "$file_path"
              ;;
            2)
              # Examples í™œë™
              file_path="examples/$today.md"
              example_index=$((RANDOM % ${#example_contents[@]}))
              echo -e "${example_contents[$example_index]}" > "$file_path"
              ;;
          esac
          
          git add "$file_path"
          
          # 30% í™•ë¥ ë¡œ ì—¬ëŸ¬ í™œë™ ìˆ˜í–‰
          if [ $should_create_multiple -lt 3 ]; then
            # ì¶”ê°€ íŒŒì¼ ìƒì„±
            second_activity=$((RANDOM % 3))
            second_content=$((RANDOM % 7))
            
            case $second_activity in
              0)
                if [ ! -f "notes/$today-extra.md" ]; then
                  echo -e "${note_contents[$second_content]}" > "notes/$today-extra.md"
                  git add "notes/$today-extra.md"
                fi
                ;;
              1)
                if [ ! -f "docs/$today-planning.md" ]; then
                  planning_index=$((RANDOM % ${#doc_contents[@]}))
                  echo -e "${doc_contents[$planning_index]}" > "docs/$today-planning.md"
                  git add "docs/$today-planning.md"
                fi
                ;;
              2)
                if [ ! -f "examples/$today-code.md" ]; then
                  code_index=$((RANDOM % ${#example_contents[@]}))
                  echo -e "${example_contents[$code_index]}" > "examples/$today-code.md"
                  git add "examples/$today-code.md"
                fi
                ;;
            esac
          fi
          
          # 10% í™•ë¥ ë¡œ README ì—…ë°ì´íŠ¸
          if [ $((RANDOM % 10)) -eq 0 ]; then
            echo -e "# ê°œë°œ í•™ìŠµ ë…¸íŠ¸\n\nê°œë°œ ê³µë¶€í•˜ë©´ì„œ ë°°ìš´ ê²ƒë“¤ì„ ê¸°ë¡í•˜ëŠ” ê°œì¸ ì €ì¥ì†Œì…ë‹ˆë‹¤.\n\n## ğŸ“š í•™ìŠµ ë‚´ìš©\n- ì›¹ ê°œë°œ (HTML, CSS, JavaScript)\n- React, Node.js\n- ì•Œê³ ë¦¬ì¦˜ & ìë£Œêµ¬ì¡°\n- ë°ì´í„°ë² ì´ìŠ¤\n- Git & GitHub\n\n## ğŸ“ ê¸°ë¡ ë°©ì‹\n- ë§¤ì¼ í•™ìŠµí•œ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì •ë¦¬\n- ì½”ë“œ ì˜ˆì œì™€ í•¨ê»˜ ë©”ëª¨\n- í”„ë¡œì íŠ¸ ì•„ì´ë””ì–´ ê¸°ë¡\n\në§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: $(date +'%Y-%m-%d')" > README.md
            git add README.md
          fi
          
          # ê°€ë” ë¹ˆ ì»¤ë°‹ë„ ìƒì„± (5% í™•ë¥ )
          if [ $((RANDOM % 20)) -eq 0 ]; then
            git commit --allow-empty -m "chore: ê°œë°œ í™˜ê²½ ì ê²€"
          fi
          
          git commit -m "${commit_messages[$message_index]}"
          git push https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }} HEAD:main 